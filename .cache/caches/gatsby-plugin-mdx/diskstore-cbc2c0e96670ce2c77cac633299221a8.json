{"expireTime":9007200851906807000,"key":"gatsby-plugin-mdx-entire-payload-f24748925c4326206505f13e9b40c41a-","val":{"mdast":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"I've got a new project on my mind. It's going to be a mobile app created with\n","position":{"start":{"line":2,"column":1,"offset":2},"end":{"line":3,"column":1,"offset":81},"indent":[1]}},{"type":"link","title":null,"url":"https://expo.io/","children":[{"type":"text","value":"Expo","position":{"start":{"line":3,"column":2,"offset":82},"end":{"line":3,"column":6,"offset":86},"indent":[]}}],"position":{"start":{"line":3,"column":1,"offset":81},"end":{"line":3,"column":25,"offset":105},"indent":[]}},{"type":"text","value":" and ","position":{"start":{"line":3,"column":25,"offset":105},"end":{"line":3,"column":30,"offset":110},"indent":[]}},{"type":"link","title":null,"url":"https://fauna.com/","children":[{"type":"text","value":"FaunaDB","position":{"start":{"line":3,"column":31,"offset":111},"end":{"line":3,"column":38,"offset":118},"indent":[]}}],"position":{"start":{"line":3,"column":30,"offset":110},"end":{"line":3,"column":59,"offset":139},"indent":[]}},{"type":"text","value":". I know that Fauna\ncan handle user authentication, im currently unsure if I will use that or not as\nI might want to implement social logins such as Facebook, Google and Twitter.\nI've used Firebase for this purpose before so am thinking I could match up the\ntwo with Fauna handling all the data requirements of the app and Firebase\nhandling the user logins. That being said, the users data will be stored in\nFauna so I might have to store it twice. This part will need some more\nconsideration.","position":{"start":{"line":3,"column":59,"offset":139},"end":{"line":10,"column":15,"offset":639},"indent":[1,1,1,1,1,1,1]}}],"position":{"start":{"line":2,"column":1,"offset":2},"end":{"line":10,"column":15,"offset":639},"indent":[1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"I have 3 children and those that have children know that as soon as you buy some\npiece of clothing for them they seem to instantly grow out of it, thus you are\nleft with basically new or totally destroyed clothing. The same can be said of\nmany toys. In fact, basically anything my children own, they seem to have for a\nshort period of time giving to outgrowing, un-interest or destruction. ðŸ˜†","position":{"start":{"line":12,"column":1,"offset":643},"end":{"line":16,"column":74,"offset":1039},"indent":[1,1,1,1]}}],"position":{"start":{"line":12,"column":1,"offset":643},"end":{"line":16,"column":74,"offset":1039},"indent":[1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Where I live there are a few Facebook groups that parents can post unused or\nsecondhand items for sale, and this is great! But there are certain things that\nyou can't do in a Facebook group that sells stuff, its quite ridged. Making an\napp for the same purpose, I could add all the missing features. Also, all the\nusers information would 100% not be shared with anyone, unlike what some big\nsocial media companies have been known to do. ðŸ˜œ","position":{"start":{"line":18,"column":1,"offset":1043},"end":{"line":23,"column":49,"offset":1487},"indent":[1,1,1,1,1]}}],"position":{"start":{"line":18,"column":1,"offset":1043},"end":{"line":23,"column":49,"offset":1487},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"This is still very early doors but like every good programmer, I started coding\nbefore I started planning. I decided to play around with fetching data from\nFauna by making some simple React hooks. Right now I only have two and im sure\nthey could be improved upon. This gist is this:","position":{"start":{"line":25,"column":1,"offset":1491},"end":{"line":28,"column":48,"offset":1776},"indent":[1,1,1]}}],"position":{"start":{"line":25,"column":1,"offset":1491},"end":{"line":28,"column":48,"offset":1776},"indent":[1,1,1]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"I have a React context provider which I pass the Fauna secret to and wrap my\napps root with","position":{"start":{"line":30,"column":3,"offset":1782},"end":{"line":31,"column":17,"offset":1876},"indent":[3]}}],"position":{"start":{"line":30,"column":3,"offset":1782},"end":{"line":31,"column":17,"offset":1876},"indent":[3]}}],"position":{"start":{"line":30,"column":1,"offset":1780},"end":{"line":31,"column":17,"offset":1876},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"Inside the provider I take secret, establish a connection with Fauna and pass\nthe client and query objects to the exported provider","position":{"start":{"line":32,"column":3,"offset":1880},"end":{"line":33,"column":56,"offset":2014},"indent":[3]}}],"position":{"start":{"line":32,"column":3,"offset":1880},"end":{"line":33,"column":56,"offset":2014},"indent":[3]}}],"position":{"start":{"line":32,"column":1,"offset":1878},"end":{"line":33,"column":56,"offset":2014},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The two hooks follow a common pattern for fetching data with 3 states,\nresponse, error and loading which they return.","position":{"start":{"line":34,"column":3,"offset":2018},"end":{"line":35,"column":49,"offset":2138},"indent":[3]}}],"position":{"start":{"line":34,"column":3,"offset":2018},"end":{"line":35,"column":49,"offset":2138},"indent":[3]}}],"position":{"start":{"line":34,"column":1,"offset":2016},"end":{"line":35,"column":49,"offset":2138},"indent":[1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The hook to get all the data takes the collection index and limit as props\nthen inside useEffect I create a paginated query for the index with the limit\nsecret","position":{"start":{"line":36,"column":3,"offset":2142},"end":{"line":38,"column":9,"offset":2307},"indent":[3,3]}}],"position":{"start":{"line":36,"column":3,"offset":2142},"end":{"line":38,"column":9,"offset":2307},"indent":[3,3]}}],"position":{"start":{"line":36,"column":1,"offset":2140},"end":{"line":38,"column":9,"offset":2307},"indent":[1,1]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"The hook to get a single item is much the same except it takes the collection\nindex and the id of the item to be fetched. The Fauna query uses the Get\nfunction to find a match for the id from the collections index","position":{"start":{"line":39,"column":3,"offset":2311},"end":{"line":41,"column":65,"offset":2530},"indent":[3,3]}}],"position":{"start":{"line":39,"column":3,"offset":2311},"end":{"line":41,"column":65,"offset":2530},"indent":[3,3]}}],"position":{"start":{"line":39,"column":1,"offset":2309},"end":{"line":41,"column":65,"offset":2530},"indent":[1,1]}}],"position":{"start":{"line":30,"column":1,"offset":1780},"end":{"line":41,"column":65,"offset":2530},"indent":[1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":43,"column":1,"offset":2534},"end":{"line":43,"column":5,"offset":2538},"indent":[]}},{"type":"link","title":null,"url":"https://docs.fauna.com/fauna/current/api/fql/","children":[{"type":"text","value":"Fauna Query Language (FQL)","position":{"start":{"line":43,"column":6,"offset":2539},"end":{"line":43,"column":32,"offset":2565},"indent":[]}}],"position":{"start":{"line":43,"column":5,"offset":2538},"end":{"line":43,"column":80,"offset":2613},"indent":[]}},{"type":"text","value":"\nseems so expansive, im really looking forward to diving into it deeper into it\nand creating the mutation hooks. Its nice practice not only of creating custom\nhooks, but also learning FQL. Not only that, I like the abstraction, all that\nlogic in one place then just import the hooks and get the data!","position":{"start":{"line":43,"column":80,"offset":2613},"end":{"line":47,"column":64,"offset":2917},"indent":[1,1,1,1]}}],"position":{"start":{"line":43,"column":1,"offset":2534},"end":{"line":47,"column":64,"offset":2917},"indent":[1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"It wouldn't be any fun if I didn't share how it was going would it? ðŸ˜„","position":{"start":{"line":49,"column":1,"offset":2921},"end":{"line":49,"column":71,"offset":2991},"indent":[]}}],"position":{"start":{"line":49,"column":1,"offset":2921},"end":{"line":49,"column":71,"offset":2991},"indent":[]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Fauna Context provider","position":{"start":{"line":51,"column":4,"offset":2998},"end":{"line":51,"column":26,"offset":3020},"indent":[]}}],"position":{"start":{"line":51,"column":1,"offset":2995},"end":{"line":51,"column":26,"offset":3020},"indent":[]}},{"type":"code","lang":"jsx","meta":null,"value":"import * as React from \"react\";\nconst faunadb = require(\"faunadb\");\nconst q = faunadb.query;\n\nexport const FaunaContext = React.createContext();\n\nexport const FaunaProvider = ({ children, faunaSecret }) => {\n    const fauna = React.useMemo(() => {\n      if (!faunaSecret) {\n        throw new Error(`No faunaSecret found, skipping client creation`);\n      }\n      const client = new faunadb.Client({\n        secret: faunaSecret\n      });\n      return { client, q };\n    }, [faunaSecret]);\n    return (\n      <FaunaContext.Provider value={fauna}>{children}</FaunaContext.Provider>\n    );\n  };","position":{"start":{"line":53,"column":1,"offset":3024},"end":{"line":74,"column":4,"offset":3646},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Then to wrap the root element of any app:","position":{"start":{"line":76,"column":1,"offset":3650},"end":{"line":76,"column":42,"offset":3691},"indent":[]}}],"position":{"start":{"line":76,"column":1,"offset":3650},"end":{"line":76,"column":42,"offset":3691},"indent":[]}},{"type":"code","lang":"jsx","meta":null,"value":"import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { FaunaProvider } from \"hooks\";\n\nimport App from \"./App\";\n\nReactDOM.render(\n  <FaunaProvider faunaSecret={process.env.FAUNA_SECRET}>\n    <App />\n  </FaunaProvider>,\n  document.getElementById(\"root\")\n);","position":{"start":{"line":78,"column":1,"offset":3695},"end":{"line":91,"column":4,"offset":3988},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"useFaunaGetAll","position":{"start":{"line":93,"column":4,"offset":3995},"end":{"line":93,"column":18,"offset":4009},"indent":[]}}],"position":{"start":{"line":93,"column":1,"offset":3992},"end":{"line":93,"column":18,"offset":4009},"indent":[]}},{"type":"code","lang":"js","meta":null,"value":"export const useFaunaGetAll = (collectionIndex, limit) => {\n  const fauna = React.useContext(FaunaContext);\n  const [response, setResponse] = React.useState(null);\n  const [error, setError] = React.useState(null);\n  const [isLoading, setIsLoading] = React.useState(false);\n\n  React.useEffect(() => {\n    const getAll = async () => {\n      setIsLoading(true);\n      try {\n        fauna.client\n          .query(\n            fauna.q.Map(\n              fauna.q.Paginate(fauna.q.Match(fauna.q.Index(collectionIndex)), {\n                size: limit\n              }),\n              fauna.q.Lambda(\n                \"ref\",\n                fauna.q.Select([\"data\"], fauna.q.Get(fauna.q.Var(\"ref\")))\n              )\n            )\n          )\n          .then(result => {\n            setResponse(result.data);\n            setIsLoading(false);\n          });\n      } catch (error) {\n        setError(error);\n      }\n      setIsLoading(false);\n    };\n    getAll();\n  }, [collectionIndex]);\n\n  return { response, error, isLoading };\n};","position":{"start":{"line":95,"column":1,"offset":4013},"end":{"line":132,"column":4,"offset":5077},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"useFaunaGetSingle","position":{"start":{"line":134,"column":4,"offset":5084},"end":{"line":134,"column":21,"offset":5101},"indent":[]}}],"position":{"start":{"line":134,"column":1,"offset":5081},"end":{"line":134,"column":21,"offset":5101},"indent":[]}},{"type":"code","lang":"js","meta":null,"value":"export const useFaunaGetSingle = (collectionIndex, id) => {\n  const fauna = React.useContext(FaunaContext);\n  const [response, setResponse] = React.useState(null);\n  const [error, setError] = React.useState(null);\n  const [isLoading, setIsLoading] = React.useState(false);\n\n  React.useEffect(() => {\n    const getSingle = async () => {\n      setIsLoading(true);\n      try {\n        fauna.client\n          .query(fauna.q.Get(fauna.q.Match(fauna.q.Index(collectionIndex), id)))\n          .then(result => {\n            setResponse(result.data);\n            setIsLoading(false);\n          });\n      } catch (error) {\n        setError(error);\n      }\n      setIsLoading(false);\n    };\n    getSingle();\n  }, [id]);\n\n  return { response, error, isLoading };\n};","position":{"start":{"line":136,"column":1,"offset":5105},"end":{"line":163,"column":4,"offset":5895},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Usage","position":{"start":{"line":165,"column":4,"offset":5902},"end":{"line":165,"column":9,"offset":5907},"indent":[]}}],"position":{"start":{"line":165,"column":1,"offset":5899},"end":{"line":165,"column":9,"offset":5907},"indent":[]}},{"type":"code","lang":"jsx","meta":null,"value":"import React from \"react\";\nimport { useFaunaGetAll, useFaunaGetSingle } from \"hooks\";\n\nconst App = () => {\n  const single = useFaunaGetSingle(\"characterById\", \"5a109e543dc2080021cd8790\");\n  const data = useFaunaGetAll(\"allCharacters\", 10);\n  return (\n    <div>\n      dum de dum dum\n      {single.isLoading || single.response === null ? (\n        <h1>Loading.....</h1>\n      ) : (\n        <h1>{single.response.name}</h1>\n      )}\n      {data.isLoading || data.response === null ? (\n        <h1>Loading Data.....</h1>\n      ) : (\n        <ul>\n          {data.response.map(item => (\n            <li key={item._id}>{item.name}</li>\n          ))}\n        </ul>\n      )}\n    </div>\n  );\n};\nexport default App;","position":{"start":{"line":167,"column":1,"offset":5911},"end":{"line":195,"column":4,"offset":6653},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Obviously there is work to be done but its a start! Now, back to planning! ðŸ’ƒðŸ•º","position":{"start":{"line":197,"column":1,"offset":6657},"end":{"line":197,"column":80,"offset":6736},"indent":[]}}],"position":{"start":{"line":197,"column":1,"offset":6657},"end":{"line":197,"column":80,"offset":6736},"indent":[]}},{"type":"export","value":"export const _frontmatter = {\"title\":\"Custom FaunaDB hooks for new project\",\"date\":\"2020-05-08T00:00:00.000Z\",\"published\":true,\"category\":\"Serverless\",\"author\":\"Richard Haines\",\"keywords\":[\"react hooks\",\"faunadb\"],\"pin\":false}","position":{"start":{"line":200,"column":1,"offset":6740},"end":{"line":200,"column":227,"offset":6966},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":200,"column":227,"offset":6966}}},"scopeImports":["import React from 'react'"],"scopeIdentifiers":["React"],"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Custom FaunaDB hooks for new project\",\n  \"date\": \"2020-05-08T00:00:00.000Z\",\n  \"published\": true,\n  \"category\": \"Serverless\",\n  \"author\": \"Richard Haines\",\n  \"keywords\": [\"react hooks\", \"faunadb\"],\n  \"pin\": false\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"I've got a new project on my mind. It's going to be a mobile app created with\\n\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://expo.io/\"\n  }), \"Expo\"), \" and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://fauna.com/\"\n  }), \"FaunaDB\"), \". I know that Fauna\\ncan handle user authentication, im currently unsure if I will use that or not as\\nI might want to implement social logins such as Facebook, Google and Twitter.\\nI've used Firebase for this purpose before so am thinking I could match up the\\ntwo with Fauna handling all the data requirements of the app and Firebase\\nhandling the user logins. That being said, the users data will be stored in\\nFauna so I might have to store it twice. This part will need some more\\nconsideration.\"), mdx(\"p\", null, \"I have 3 children and those that have children know that as soon as you buy some\\npiece of clothing for them they seem to instantly grow out of it, thus you are\\nleft with basically new or totally destroyed clothing. The same can be said of\\nmany toys. In fact, basically anything my children own, they seem to have for a\\nshort period of time giving to outgrowing, un-interest or destruction. \\uD83D\\uDE06\"), mdx(\"p\", null, \"Where I live there are a few Facebook groups that parents can post unused or\\nsecondhand items for sale, and this is great! But there are certain things that\\nyou can't do in a Facebook group that sells stuff, its quite ridged. Making an\\napp for the same purpose, I could add all the missing features. Also, all the\\nusers information would 100% not be shared with anyone, unlike what some big\\nsocial media companies have been known to do. \\uD83D\\uDE1C\"), mdx(\"p\", null, \"This is still very early doors but like every good programmer, I started coding\\nbefore I started planning. I decided to play around with fetching data from\\nFauna by making some simple React hooks. Right now I only have two and im sure\\nthey could be improved upon. This gist is this:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"I have a React context provider which I pass the Fauna secret to and wrap my\\napps root with\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Inside the provider I take secret, establish a connection with Fauna and pass\\nthe client and query objects to the exported provider\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The two hooks follow a common pattern for fetching data with 3 states,\\nresponse, error and loading which they return.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The hook to get all the data takes the collection index and limit as props\\nthen inside useEffect I create a paginated query for the index with the limit\\nsecret\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The hook to get a single item is much the same except it takes the collection\\nindex and the id of the item to be fetched. The Fauna query uses the Get\\nfunction to find a match for the id from the collections index\")), mdx(\"p\", null, \"The \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://docs.fauna.com/fauna/current/api/fql/\"\n  }), \"Fauna Query Language (FQL)\"), \"\\nseems so expansive, im really looking forward to diving into it deeper into it\\nand creating the mutation hooks. Its nice practice not only of creating custom\\nhooks, but also learning FQL. Not only that, I like the abstraction, all that\\nlogic in one place then just import the hooks and get the data!\"), mdx(\"p\", null, \"It wouldn't be any fun if I didn't share how it was going would it? \\uD83D\\uDE04\"), mdx(\"h2\", {\n    \"id\": \"fauna-context-provider\"\n  }, \"Fauna Context provider\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-jsx\"\n  }), \"import * as React from \\\"react\\\";\\nconst faunadb = require(\\\"faunadb\\\");\\nconst q = faunadb.query;\\n\\nexport const FaunaContext = React.createContext();\\n\\nexport const FaunaProvider = ({ children, faunaSecret }) => {\\n    const fauna = React.useMemo(() => {\\n      if (!faunaSecret) {\\n        throw new Error(`No faunaSecret found, skipping client creation`);\\n      }\\n      const client = new faunadb.Client({\\n        secret: faunaSecret\\n      });\\n      return { client, q };\\n    }, [faunaSecret]);\\n    return (\\n      <FaunaContext.Provider value={fauna}>{children}</FaunaContext.Provider>\\n    );\\n  };\\n\")), mdx(\"p\", null, \"Then to wrap the root element of any app:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-jsx\"\n  }), \"import React from \\\"react\\\";\\nimport ReactDOM from \\\"react-dom\\\";\\nimport { FaunaProvider } from \\\"hooks\\\";\\n\\nimport App from \\\"./App\\\";\\n\\nReactDOM.render(\\n  <FaunaProvider faunaSecret={process.env.FAUNA_SECRET}>\\n    <App />\\n  </FaunaProvider>,\\n  document.getElementById(\\\"root\\\")\\n);\\n\")), mdx(\"h2\", {\n    \"id\": \"usefaunagetall\"\n  }, \"useFaunaGetAll\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"export const useFaunaGetAll = (collectionIndex, limit) => {\\n  const fauna = React.useContext(FaunaContext);\\n  const [response, setResponse] = React.useState(null);\\n  const [error, setError] = React.useState(null);\\n  const [isLoading, setIsLoading] = React.useState(false);\\n\\n  React.useEffect(() => {\\n    const getAll = async () => {\\n      setIsLoading(true);\\n      try {\\n        fauna.client\\n          .query(\\n            fauna.q.Map(\\n              fauna.q.Paginate(fauna.q.Match(fauna.q.Index(collectionIndex)), {\\n                size: limit\\n              }),\\n              fauna.q.Lambda(\\n                \\\"ref\\\",\\n                fauna.q.Select([\\\"data\\\"], fauna.q.Get(fauna.q.Var(\\\"ref\\\")))\\n              )\\n            )\\n          )\\n          .then(result => {\\n            setResponse(result.data);\\n            setIsLoading(false);\\n          });\\n      } catch (error) {\\n        setError(error);\\n      }\\n      setIsLoading(false);\\n    };\\n    getAll();\\n  }, [collectionIndex]);\\n\\n  return { response, error, isLoading };\\n};\\n\")), mdx(\"h2\", {\n    \"id\": \"usefaunagetsingle\"\n  }, \"useFaunaGetSingle\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-js\"\n  }), \"export const useFaunaGetSingle = (collectionIndex, id) => {\\n  const fauna = React.useContext(FaunaContext);\\n  const [response, setResponse] = React.useState(null);\\n  const [error, setError] = React.useState(null);\\n  const [isLoading, setIsLoading] = React.useState(false);\\n\\n  React.useEffect(() => {\\n    const getSingle = async () => {\\n      setIsLoading(true);\\n      try {\\n        fauna.client\\n          .query(fauna.q.Get(fauna.q.Match(fauna.q.Index(collectionIndex), id)))\\n          .then(result => {\\n            setResponse(result.data);\\n            setIsLoading(false);\\n          });\\n      } catch (error) {\\n        setError(error);\\n      }\\n      setIsLoading(false);\\n    };\\n    getSingle();\\n  }, [id]);\\n\\n  return { response, error, isLoading };\\n};\\n\")), mdx(\"h2\", {\n    \"id\": \"usage\"\n  }, \"Usage\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-jsx\"\n  }), \"import React from \\\"react\\\";\\nimport { useFaunaGetAll, useFaunaGetSingle } from \\\"hooks\\\";\\n\\nconst App = () => {\\n  const single = useFaunaGetSingle(\\\"characterById\\\", \\\"5a109e543dc2080021cd8790\\\");\\n  const data = useFaunaGetAll(\\\"allCharacters\\\", 10);\\n  return (\\n    <div>\\n      dum de dum dum\\n      {single.isLoading || single.response === null ? (\\n        <h1>Loading.....</h1>\\n      ) : (\\n        <h1>{single.response.name}</h1>\\n      )}\\n      {data.isLoading || data.response === null ? (\\n        <h1>Loading Data.....</h1>\\n      ) : (\\n        <ul>\\n          {data.response.map(item => (\\n            <li key={item._id}>{item.name}</li>\\n          ))}\\n        </ul>\\n      )}\\n    </div>\\n  );\\n};\\nexport default App;\\n\")), mdx(\"p\", null, \"Obviously there is work to be done but its a start! Now, back to planning! \\uD83D\\uDC83\\uD83D\\uDD7A\"));\n}\n;\nMDXContent.isMDXComponent = true;","rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nexport const _frontmatter = {\n  \"title\": \"Custom FaunaDB hooks for new project\",\n  \"date\": \"2020-05-08T00:00:00.000Z\",\n  \"published\": true,\n  \"category\": \"Serverless\",\n  \"author\": \"Richard Haines\",\n  \"keywords\": [\"react hooks\", \"faunadb\"],\n  \"pin\": false\n};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <p>{`I've got a new project on my mind. It's going to be a mobile app created with\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://expo.io/\"\n      }}>{`Expo`}</a>{` and `}<a parentName=\"p\" {...{\n        \"href\": \"https://fauna.com/\"\n      }}>{`FaunaDB`}</a>{`. I know that Fauna\ncan handle user authentication, im currently unsure if I will use that or not as\nI might want to implement social logins such as Facebook, Google and Twitter.\nI've used Firebase for this purpose before so am thinking I could match up the\ntwo with Fauna handling all the data requirements of the app and Firebase\nhandling the user logins. That being said, the users data will be stored in\nFauna so I might have to store it twice. This part will need some more\nconsideration.`}</p>\n    <p>{`I have 3 children and those that have children know that as soon as you buy some\npiece of clothing for them they seem to instantly grow out of it, thus you are\nleft with basically new or totally destroyed clothing. The same can be said of\nmany toys. In fact, basically anything my children own, they seem to have for a\nshort period of time giving to outgrowing, un-interest or destruction. ðŸ˜†`}</p>\n    <p>{`Where I live there are a few Facebook groups that parents can post unused or\nsecondhand items for sale, and this is great! But there are certain things that\nyou can't do in a Facebook group that sells stuff, its quite ridged. Making an\napp for the same purpose, I could add all the missing features. Also, all the\nusers information would 100% not be shared with anyone, unlike what some big\nsocial media companies have been known to do. ðŸ˜œ`}</p>\n    <p>{`This is still very early doors but like every good programmer, I started coding\nbefore I started planning. I decided to play around with fetching data from\nFauna by making some simple React hooks. Right now I only have two and im sure\nthey could be improved upon. This gist is this:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`I have a React context provider which I pass the Fauna secret to and wrap my\napps root with`}</li>\n      <li parentName=\"ul\">{`Inside the provider I take secret, establish a connection with Fauna and pass\nthe client and query objects to the exported provider`}</li>\n      <li parentName=\"ul\">{`The two hooks follow a common pattern for fetching data with 3 states,\nresponse, error and loading which they return.`}</li>\n      <li parentName=\"ul\">{`The hook to get all the data takes the collection index and limit as props\nthen inside useEffect I create a paginated query for the index with the limit\nsecret`}</li>\n      <li parentName=\"ul\">{`The hook to get a single item is much the same except it takes the collection\nindex and the id of the item to be fetched. The Fauna query uses the Get\nfunction to find a match for the id from the collections index`}</li>\n    </ul>\n    <p>{`The `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.fauna.com/fauna/current/api/fql/\"\n      }}>{`Fauna Query Language (FQL)`}</a>{`\nseems so expansive, im really looking forward to diving into it deeper into it\nand creating the mutation hooks. Its nice practice not only of creating custom\nhooks, but also learning FQL. Not only that, I like the abstraction, all that\nlogic in one place then just import the hooks and get the data!`}</p>\n    <p>{`It wouldn't be any fun if I didn't share how it was going would it? ðŸ˜„`}</p>\n    <h2 {...{\n      \"id\": \"fauna-context-provider\"\n    }}>{`Fauna Context provider`}</h2>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-jsx\"\n      }}>{`import * as React from \"react\";\nconst faunadb = require(\"faunadb\");\nconst q = faunadb.query;\n\nexport const FaunaContext = React.createContext();\n\nexport const FaunaProvider = ({ children, faunaSecret }) => {\n    const fauna = React.useMemo(() => {\n      if (!faunaSecret) {\n        throw new Error(\\`No faunaSecret found, skipping client creation\\`);\n      }\n      const client = new faunadb.Client({\n        secret: faunaSecret\n      });\n      return { client, q };\n    }, [faunaSecret]);\n    return (\n      <FaunaContext.Provider value={fauna}>{children}</FaunaContext.Provider>\n    );\n  };\n`}</code></pre>\n    <p>{`Then to wrap the root element of any app:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-jsx\"\n      }}>{`import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { FaunaProvider } from \"hooks\";\n\nimport App from \"./App\";\n\nReactDOM.render(\n  <FaunaProvider faunaSecret={process.env.FAUNA_SECRET}>\n    <App />\n  </FaunaProvider>,\n  document.getElementById(\"root\")\n);\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"usefaunagetall\"\n    }}>{`useFaunaGetAll`}</h2>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`export const useFaunaGetAll = (collectionIndex, limit) => {\n  const fauna = React.useContext(FaunaContext);\n  const [response, setResponse] = React.useState(null);\n  const [error, setError] = React.useState(null);\n  const [isLoading, setIsLoading] = React.useState(false);\n\n  React.useEffect(() => {\n    const getAll = async () => {\n      setIsLoading(true);\n      try {\n        fauna.client\n          .query(\n            fauna.q.Map(\n              fauna.q.Paginate(fauna.q.Match(fauna.q.Index(collectionIndex)), {\n                size: limit\n              }),\n              fauna.q.Lambda(\n                \"ref\",\n                fauna.q.Select([\"data\"], fauna.q.Get(fauna.q.Var(\"ref\")))\n              )\n            )\n          )\n          .then(result => {\n            setResponse(result.data);\n            setIsLoading(false);\n          });\n      } catch (error) {\n        setError(error);\n      }\n      setIsLoading(false);\n    };\n    getAll();\n  }, [collectionIndex]);\n\n  return { response, error, isLoading };\n};\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"usefaunagetsingle\"\n    }}>{`useFaunaGetSingle`}</h2>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-js\"\n      }}>{`export const useFaunaGetSingle = (collectionIndex, id) => {\n  const fauna = React.useContext(FaunaContext);\n  const [response, setResponse] = React.useState(null);\n  const [error, setError] = React.useState(null);\n  const [isLoading, setIsLoading] = React.useState(false);\n\n  React.useEffect(() => {\n    const getSingle = async () => {\n      setIsLoading(true);\n      try {\n        fauna.client\n          .query(fauna.q.Get(fauna.q.Match(fauna.q.Index(collectionIndex), id)))\n          .then(result => {\n            setResponse(result.data);\n            setIsLoading(false);\n          });\n      } catch (error) {\n        setError(error);\n      }\n      setIsLoading(false);\n    };\n    getSingle();\n  }, [id]);\n\n  return { response, error, isLoading };\n};\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"usage\"\n    }}>{`Usage`}</h2>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-jsx\"\n      }}>{`import React from \"react\";\nimport { useFaunaGetAll, useFaunaGetSingle } from \"hooks\";\n\nconst App = () => {\n  const single = useFaunaGetSingle(\"characterById\", \"5a109e543dc2080021cd8790\");\n  const data = useFaunaGetAll(\"allCharacters\", 10);\n  return (\n    <div>\n      dum de dum dum\n      {single.isLoading || single.response === null ? (\n        <h1>Loading.....</h1>\n      ) : (\n        <h1>{single.response.name}</h1>\n      )}\n      {data.isLoading || data.response === null ? (\n        <h1>Loading Data.....</h1>\n      ) : (\n        <ul>\n          {data.response.map(item => (\n            <li key={item._id}>{item.name}</li>\n          ))}\n        </ul>\n      )}\n    </div>\n  );\n};\nexport default App;\n`}</code></pre>\n    <p>{`Obviously there is work to be done but its a start! Now, back to planning! ðŸ’ƒðŸ•º`}</p>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}